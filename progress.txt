## 2026-01-14: URL/History Management Fix

### Task: Part 3 - URL/History Management Fix (The Big Bug!)

### Changes Made:
- `src/components/stack-cloud/stack-node.tsx:132`: Changed `router.push()` to `router.replace()`
- `src/components/stack-cloud/root-node-chart.tsx:855`: Changed `router.push()` to `router.replace()`
- `src/components/search-input.tsx:57,94,162`: Changed `router.replace()` to `router.push()`

### Rationale:
- Stack nodes and pie chart segments now use `router.replace()` - when clicking filters, you're refining the SAME view, so we don't add to browser history
- Search input now uses `router.push()` - when searching, you're making a NEW query, so back button should return to previous search

### Result:
- TypeScript type checks pass
- Back button now works correctly for search (push = add to history)
- Filter clicks don't pollute browser history (replace = stay on same history entry)

## 2026-01-14: ASCII Clouds Background

### Task: Part 4 - ASCII Clouds (The Sky Is Thinking!)

### Changes Made:
- `src/styles/globals.css`: Added `body::before` pseudo-element with ASCII cloud pattern

### Implementation Details:
- Uses SVG data URI with ASCII art cloud patterns in monospace font
- Cloud colors use Klein blue (#002FA7) to match site theme
- Very subtle opacity (0.025) for non-intrusive background effect
- Fixed positioning with `z-index: -1` to stay behind all content
- `pointer-events: none` to not interfere with interactions
- Pattern repeats seamlessly across the viewport

### Accessibility:
- Respects `prefers-reduced-motion: reduce` by hiding clouds
- Hidden in print mode to save ink and reduce visual noise

### Result:
- TypeScript type checks pass
- Knip passes (no unused code)
- Subtle ASCII clouds visible in background as decorative element

## 2026-01-14: Accessibility - Live Regions for Project Filtering

### Task: Part 5 - Accessibility (WCAG 2.2 SC 4.1.3 - Status Messages)

### Changes Made:
- `src/components/projects.tsx`: Added aria-live region for screen reader announcements

### Implementation Details:
- Added `role="status"` with `aria-live="polite"` and `aria-atomic="true"` for screen reader announcements
- Announces filter results when user searches or filters projects:
  - "X projects found for 'search term'"
  - "No projects found for 'search term'"
  - "Showing all X projects" (when filter cleared)
- Uses `sr-only` class to visually hide the announcement while keeping it accessible to screen readers
- Skips announcement on initial page load to avoid announcing default state

### Accessibility:
- Complies with WCAG 2.2 SC 4.1.3 (Status Messages) - Level AA
- Screen reader users are now informed when project list changes due to filtering
- Uses `polite` aria-live to avoid interrupting current screen reader announcements

### Result:
- TypeScript type checks pass
- Knip passes (no unused code)
- Screen readers now announce project filtering results

## 2026-01-14: Project Display Simplification

### Task: Part 2 - Project Display (Make It Simple!)

### Changes Made:
- `src/components/projects.tsx`: Removed View Transitions API
  - Removed `flushSync` import from react-dom
  - Removed `ViewTransition` ref tracking
  - Removed Safari macOS browser detection
  - Removed `startViewTransition()` API usage
  - Simplified to direct state updates with CSS animations
- `src/components/project.tsx`: Removed view-transition-name
  - Removed `--vt-project-name` CSS custom property
  - Added `.project-enter` and `.project-stay` CSS classes based on state
- `src/styles/globals.css`: Simplified animation CSS
  - Removed 200+ lines of `::view-transition-*` pseudo-element selectors
  - Removed hardcoded selectors for PROJECT_0 through PROJECT_10
  - Removed old keyframes (vt-project-exit-old, vt-project-enter-new, etc.)
  - Removed view-transition-name from header
  - Added simple `@keyframes project-fade-in-up` and `@keyframes project-pulse`
  - Simplified `.project-item` styles to just base + enter/stay animations
  - Simplified `.empty-state-container` to simple fade transition
  - Updated reduced-motion preferences for new animation classes

### Rationale:
- View Transitions API caused Safari-specific bugs requiring browser detection hacks
- Complex z-index management (z-19 to z-22) was hard to maintain
- 200+ lines of hardcoded CSS selectors for each project was not scalable
- Simple CSS animations work everywhere without browser-specific workarounds

### New Animation System:
- `.project-enter`: Fade in + translateY(20px) animation, staggered by index (50ms per item)
- `.project-stay`: Subtle scale pulse (1 → 1.02 → 1) to indicate item remains
- Both respect `prefers-reduced-motion: reduce`

### Result:
- TypeScript type checks pass
- Knip passes (no unused code)
- Build succeeds
- CSS reduced from ~1070 lines to ~625 lines
- No more Safari-specific hacks needed
- Simpler, more maintainable animation system

## 2026-01-14: Accessibility - ARIA Hidden for Decorative SVG Elements

### Task: Part 5 - Accessibility (WCAG 2.2 SC 1.1.1 - Non-text Content)

### Changes Made:
- `src/components/stack-cloud/stack-node.tsx`: Added `aria-hidden="true"` to decorative SVG elements
- `src/components/stack-cloud/root-node-experience.tsx`: Added `aria-hidden="true"` to decorative icon containers

### Implementation Details:
- Stack node SVG elements marked as decorative:
  - Main node circle (line 203-211)
  - Inner fill circle for selected state (line 215-222)
  - Focus ring circle (line 225-232)
  - Icon group (line 236-251)
- Root node experience icons marked as decorative:
  - Default mode chart pie icon (line 120-133)
  - Stack mode technology icon (line 149-169)
  - Domain mode domain icon (line 190-210)

### Rationale:
- These visual elements are decorative - the semantic meaning is provided by:
  - Parent `<g>` with `aria-label` for stack nodes
  - Adjacent text labels for experience icons
- Screen readers should skip decorative elements to avoid verbose/confusing output
- Follows WCAG 2.2 best practice: "Decorative images should have empty alt or aria-hidden"

### Result:
- TypeScript type checks pass
- Knip passes (no unused code)
- Screen readers will skip decorative SVG elements, providing cleaner navigation

## 2026-01-14: Accessibility - Enhanced Focus Indicators

### Task: Part 5 - Accessibility (WCAG 2.2 SC 2.4.11 - Focus Appearance)

### Changes Made:
- `src/styles/globals.css`: Updated focus utility classes to use `focus-visible` instead of `focus`
  - `.focus-standard`: Changed to `focus-visible:ring-2 focus-visible:ring-klein`
  - `.focus-button`: Changed to `focus-visible:ring-2` with background change
  - `.focus-badge`: Changed to `focus-visible:outline-2`
  - Added new `.focus-link` class for inline links with proper ring styling
- `src/components/project.tsx`: Added `focus-link` class to company links
- `src/components/search-input.tsx`: Updated clear button to use `focus-visible` styles

### Implementation Details:
- All focus indicators use 2px ring/outline minimum (WCAG 2.2 Enhanced requirement)
- Klein blue (#002FA7) used for focus color - provides high contrast against white background
- Using `focus-visible` instead of `focus` ensures focus rings only appear on keyboard navigation
- Project company links now have proper visible focus indicators for keyboard users
- Search input clear button has consistent focus ring styling

### Accessibility:
- Complies with WCAG 2.2 SC 2.4.11 (Focus Appearance - Enhanced) - Level AAA
- Focus indicators meet 3:1 contrast ratio requirement
- All interactive elements have visible keyboard focus indicators
- Using `focus-visible` prevents unnecessary focus rings on mouse clicks

### Result:
- TypeScript type checks pass
- Knip passes (no unused code)
- All interactive elements have WCAG-compliant focus indicators

## 2026-01-14: Accessibility - Expanded Skip Links

### Task: Part 5 - Accessibility (WCAG 2.2 SC 2.4.1 - Bypass Blocks)

### Changes Made:
- `src/components/stack-cloud/stack-cloud.tsx`: Added `id="stack"` to main container
- `src/components/skip-links.tsx`: Added "Skip to stack" link before existing "Skip to projects" link

### Implementation Details:
- Skip links now provide two navigation targets: Stack and Projects
- Stack section is the main visualization area on the left side of the page
- Projects section is the project list on the right side
- Both links are visually hidden but appear on keyboard focus
- Links are in logical order (Stack appears first in DOM, Projects second)

### Accessibility:
- Complies with WCAG 2.2 SC 2.4.1 (Bypass Blocks) - Level A
- Keyboard users can now quickly navigate to either main content section
- Skip links appear in natural reading order (left to right content flow)

### Result:
- TypeScript type checks pass
- Knip passes (no unused code)
- Skip navigation now covers both main content areas
